import zarr
import json
from tqdm import tqdm

NUM_FILES = 1231
LARGE_STRING = """"mbox":"b'X-GM-THRID: 1712170930758057527\\r\\nX-Gmail-Labels: Inbox,Category Personal,Unread\\r\\nDelivered-To: dallinhutchison@gmail.com\\r\\nReceived: by 2002:a59:d031:0:b0:22d:68b8:1740 with SMTP id bh17csp4584536vqb;\\r\\n        Tue, 28 Sep 2021 11:24:01 -0700 (PDT)\\r\\nX-Google-Smtp-Source: \\r\\n ABdhPJzW+PPJlWfR2fm2ZqjWyIQflGS/0fp1MScFZwiAxGPMHHAzDLOBtnhHjxN+tWOjbrxU6n+C\\r\\nX-Received: by 2002:a05:6e02:893:: with SMTP id\\r\\n z19mr5443006ils.224.1632853441565;\\r\\n        Tue, 28 Sep 2021 11:24:01 -0700 (PDT)\\r\\nARC-Seal: i=2; a=rsa-sha256; t=1632853441; cv=pass;\\r\\n        d=google.com; s=arc-20160816;\\r\\n        b=GYL4owvYjBdK4eFqR5Mlih1OnUSxnt0OSJaOmUxXrK+EWdcRgI//ZZ/QCY2X9v1uoT\\r\\n         pDnMFLpfVHKS8L7lAlrIeTTfUjsaqef8wGbSwFj6+Wygwof7grZh8CO4/UEUXrXkO0P+\\r\\n         m52WMNEBnjpJf0PoFktTsfyseg4DJ3zlzg8/gp1C+h+Xe28PVlKWU6/hrezPFNIfelf3\\r\\n         Zk3g8B5Ja7INFIVPjutfVwybTILj/QPTsiGZOWW8e7RLKvzQYPgaKKq3lk4uLgJiWcAr\\r\\n         qmyWPpwU+Ag82Wp8p7442M7lP6D65zmsEcRzdoA0T5Fy+UBeAdnXiX9Z8Xus7yaU0CRi\\r\\n         ROMw==\\r\\nARC-Message-Signature: i=2; a=rsa-sha256; c=relaxed/relaxed; d=google.com;\\r\\n s=arc-20160816;\\r\\n        h=mime-version:content-language:accept-language:in-reply-to\\r\\n         :references:message-id:date:importance:thread-index:thread-topic\\r\\n         :subject:to:from:dkim-signature;\\r\\n        bh=Maq/u1JllQAaXZln4UdC2fpmJy+JMxgMK9MxdV3AdWk=;\\r\\n        b=bLXBwzTotP9P4uXO//TBbP6+/qs2F2VOandNFuXvK3J9ubg5s8N447ssN5mBAD1aRw\\r\\n         sUzjQvM99z9gnAAuCQ+KlmlwUCWUiOdvXSB1u4HvBBMuDqXn7yk5+MtGSPqGWB8zjDi9\\r\\n         oq28GrOhwIWE6J6lqO1j3mBzH1WdTPaHqHNz6kRVXCsauxkFqTuzSXHxWYZiwyUsJo2S\\r\\n         k3ywStAWwGSUcMnGDqpeGHwQ85KkTIuS/GJ7nsOmV1WAyoG7AiOoSHYD/Kso9WH1BNGc\\r\\n         HVI39GyG9G1Qw8OhdHUtCVu+eQwaU6MKMubOOdzw3uzVDtZ3TgqkfdBDcP48qyJFKQ1q\\r\\n         CY4w==\\r\\nARC-Authentication-Results: i=2; mx.google.com;\\r\\n       dkim=pass header.i=@byu.edu header.s=selector2 header.b=nGpYAhXS;\\r\\n       arc=pass (i=1 spf=pass spfdomain=byu.edu dkim=pass dkdomain=byu.edu\\r\\n dmarc=pass fromdomain=byu.edu);\\r\\n       spf=pass (google.com: domain of vika_filimoeatu@byu.edu designates\\r\\n 128.187.16.187 as permitted sender) smtp.mailfrom=vika_filimoeatu@byu.edu;\\r\\n       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=byu.edu\\r\\nReturn-Path: <vika_filimoeatu@byu.edu>\\r\\nReceived: from agw3.byu.edu (agw3.byu.edu. [128.187.16.187])\\r\\n        by mx.google.com with ESMTPS id k64si25389851iof.8.2021.09.28.11.24.00\\r\\n        (version=TLS1_2 cipher=ECDHE-ECDSA-AES128-GCM-SHA256 bits=128/128);\\r\\n        Tue, 28 Sep 2021 11:24:01 -0700 (PDT)\\r\\nReceived-SPF: pass (google.com: domain of vika_filimoeatu@byu.edu designates\\r\\n 128.187.16.187 as permitted sender) client-ip=128.187.16.187;\\r\\nAuthentication-Results: mx.google.com;\\r\\n       dkim=pass header.i=@byu.edu header.s=selector2 header.b=nGpYAhXS;\\r\\n       arc=pass (i=1 spf=pass spfdomain=byu.edu dkim=pass dkdomain=byu.edu\\r\\n dmarc=pass fromdomain=byu.edu);\\r\\n       spf=pass (google.com: domain of vika_filimoeatu@byu.edu designates\\r\\n 128.187.16.187 as permitted sender) smtp.mailfrom=vika_filimoeatu@byu.edu;\\r\\n       dmarc=pass (p=NONE sp=NONE dis=NONE) header.from=byu.edu\\r\\nReceived: from canstore2.byu.edu (canstore2.byu.edu [10.18.21.138])\\r\\n\\tby agw3.byu.edu (Postfix) with ESMTPS id 7A8B81AC36;\\r\\n\\tTue, 28 Sep 2021 12:23:59 -0600 (MDT)\\r\\nReceived: from Exchange2.byu.local (exchange2.byu.edu [128.187.16.131])\\r\\n\\tby canstore2.byu.edu (8.15.2/8.15.2/Debian-8+deb9u1) with ESMTPS id\\r\\n 18SINej0016125\\r\\n\\t(version=TLSv1.2 cipher=ECDHE-RSA-AES128-GCM-SHA256 bits=128 verify=NOT);\\r\\n\\tTue, 28 Sep 2021 12:23:43 -0600\\r\\nReceived: from Exchange2.byu.local (128.187.16.131) by Exchange2.byu.local\\r\\n (128.187.16.131) with Microsoft SMTP Server (version=TLS1_2,\\r\\n cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.1.2308.14; Tue, 28 Sep\\r\\n 2021 12:23:42 -0600\\r\\nReceived: from NAM10-BN7-obe.outbound.protection.outlook.com (104.47.70.103)\\r\\n by Exchange2.byu.local (128.187.16.128) with Microsoft SMTP Server\\r\\n (version=TLS1_2, cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id\\r\\n 15.1.2308.14 via Frontend Transport; Tue, 28 Sep 2021 12:23:41 -0600\\r\\nARC-Seal: i=1; a=rsa-sha256; s=arcselector9901; d=microsoft.com; cv=none;\\r\\n b=ZJ0jz4gJlCjrbxQA3ju4AQRIHxBmCFOY1jYtdZWltierQif13SosXd5mKXAmoZ2eOVxAaD6pWzq35Gf56gVnYyxoxJnxtejQRGSFj9TewC0aMGPjuviUf3zKQDbHquDzIMB+uIY9/bG7esED690UFgEZGlw7y9kS4isllZQec2mxUJjA8REzI3P4833gSRwi4Vz7j4gSMjvCAnTiApmHqxMBExn7kEfADxUNTnc5K07Py4PNxPOfSUggJBEmzAHvJpOZ4Dw3ou66pLWGjmw85q8o6tY+17VEviwx3HYyPxvOLX0Kz7XKcu7o32TYFwM9Y3yCygWM8nGDirSg+8ataA==\\r\\nARC-Message-Signature: i=1; a=rsa-sha256; c=relaxed/relaxed; d=microsoft.com;\\r\\n s=arcselector9901; h=From:Date:Subject:Message-ID:Content-Type:MIME-Version;\\r\\n bh=Maq/u1JllQAaXZln4UdC2fpmJy+JMxgMK9MxdV3AdWk=;\\r\\n b=DI2jhpDIpe4m6i3al8Q7dBqHW4jKNVGt//dFG9xh2mwM878apT5qEdptFCLrTD1lRi0t/gOkyphh2JKRbJ4qP9mIDhN8WUxQzKIUmUEOUSvoim7tFMzGyruu63o62Eokt7LBa+Lvl2ZQ1VgA2MI9UwQeI7TB9MvkB+7L/PlCS8VSOdMrcIZ/0xeidHhtNi+afV4bHwaSqj3RgVO5knCn32ku1wEwnmrgi92jUmQPvWRymMkd43/3vCcfXpcJf/ggBTmm6+Og5yuy/+Chgi4mFcbwKoBENbg4/4q6kb+bi2Zg0JDJNm+tHjxhUvpPd1I+h7KU4LPzy+MnHqKZOHlRVQ==\\r\\nARC-Authentication-Results: i=1; mx.microsoft.com 1; spf=pass\\r\\n smtp.mailfrom=byu.edu; dmarc=pass action=none header.from=byu.edu; dkim=pass\\r\\n header.d=byu.edu; arc=none\\r\\nDKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=byu.edu; s=selector2;\\r\\n h=From:Date:Subject:Message-ID:Content-Type:MIME-Version:X-MS-Exchange-SenderADCheck;\\r\\n bh=Maq/u1JllQAaXZln4UdC2fpmJy+JMxgMK9MxdV3AdWk=;\\r\\n b=nGpYAhXSkh1474hxDXGVOGBU3dPh1TI9V8A/REzPIHcJVn8zN/oDo86+e/Z39BjlaoYBlvk7P8x3WUlNXB6CJxvWfyjoQgeupoMmnBXEPuntJ/2WtAvvZtHfNbKgPguekEPsE4N8zzxwEnLccS6okAzoc4xCk+gopTVEJ0GhysM=\\r\\nReceived: from BY5PR08MB6421.namprd08.prod.outlook.com (2603:10b6:a03:1ef::11)\\r\\n by SJ0PR08MB6734.namprd08.prod.outlook.com (2603:10b6:a03:2ad::9) with\\r\\n Microsoft SMTP Server (version=TLS1_2,\\r\\n cipher=TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384) id 15.20.4544.18; Tue, 28 Sep\\r\\n 2021 18:23:00 +0000\\r\\nReceived: from BY5PR08MB6421.namprd08.prod.outlook.com\\r\\n ([fe80::384d:3a14:ad88:83ea]) by BY5PR08MB6421.namprd08.prod.outlook.com\\r\\n ([fe80::384d:3a14:ad88:83ea%5]) with mapi id 15.20.4544.021; Tue, 28 Sep 2021\\r\\n 18:23:00 +0000\\r\\nFrom: Vika Filimoeatu <vika_filimoeatu@byu.edu>\\r\\nTo: Honors <honors@byu.edu>\\r\\nSubject: Honors Leadership Class in 2nd Term!\\r\\nThread-Topic: Honors Leadership Class in 2nd Term!\\r\\nThread-Index: AdewlgCltLYpIumaQ4e7pR/fyrWNxwD/4r6Q\\r\\nImportance: high\\r\\nX-Priority: 1\\r\\nDate: Tue, 28 Sep 2021 18:22:58 +0000\\r\\nMessage-ID: \\r\\n <BY5PR08MB6421D3689498FE99696DD77689A89@BY5PR08MB6421.namprd08.prod.outlook.com>\\r\\nReferences: \\r\\n <BY5PR08MB642179D17ABD4CE50B0B426F89A39@BY5PR08MB6421.namprd08.prod.outlook.com>\\r\\nIn-Reply-To: \\r\\n <BY5PR08MB642179D17ABD4CE50B0B426F89A39@BY5PR08MB6421.namprd08.prod.outlook.com>\\r\\nAccept-Language: en-US\\r\\nContent-Language: en-US\\r\\nX-MS-Has-Attach: \\r\\nX-MS-TNEF-Correlator: \\r\\nauthentication-results: byu.edu; dkim=none (message not signed)\\r\\n header.d=none;byu.edu; dmarc=none action=none header.from=byu.edu;\\r\\nx-ms-publictraffictype: Email\\r\\nx-ms-office365-filtering-correlation-id: cb48c39c-7069-4e77-dedc-08d982ad00af\\r\\nx-ms-traffictypediagnostic: SJ0PR08MB6734:\\r\\nx-ld-processed: c6fc6e9b-51fb-48a8-b779-9ee564b40413,ExtAddr\\r\\nx-ms-exchange-transport-forked: True\\r\\nx-microsoft-antispam-prvs: \\r\\n <SJ0PR08MB673482DC2B607D92A62365B289A89@SJ0PR08MB6734.namprd08.prod.outlook.com>\\r\\nx-ms-oob-tlc-oobclassifiers: OLM:9508;\\r\\nx-ms-exchange-senderadcheck: 1\\r\\nx-ms-exchange-antispam-relay: 0\\r\\nx-microsoft-antispam: BCL:0;\\r\\nx-microsoft-antispam-message-info: \\r\\n 8rWPw5YyoNWkaRbpZbxwrfVeG90i5iiaTOqyj0m0iFtnG6aBkovPfJfnFS7y/QXKYCUc7La6QcYK2pDo9vrAphiwNMfCSQQ0vaifyx3YCT4zfCuiyLusTJBBpNXV24ASYpSFKZQa80TtlZTpJArfQxA9NbIdH3LtV/SYSUtVq18rOxX8ggOFcSjZGUqxBJq0KnCDiyjeVqYfQ9dHi/8OP55QaNTYXY2cWKll/ebhTcUkE2iTH72Zcun7EzSN3xZ7JrV1P5JgBc9qo3QBUzWm9BDcXdqGoTYOe1Tgj5k75rbnLyYgAqG/M/4MTAQgMZOFuTl8OMTAcNwqrq0kDsNG8eQ4mvMzd1pcIKcAbeBNkdSPuuzkfvctmhRhkUxBbviciTFJOFc6CIf5TcMWdISbejmu8bnGkhsHMmEDe1X41pTkyckmIAEMvf2R9cNaAgDlunmZe6x2N5rW+P0IUij2O9hvAAFYOnXuXPS+8bLEc3Ax9P8eFu1rfy1+VRCvFPEL3hlx4XrokJJOqCYo/XED+v02tD1hQXSBH0711Ob4kzCn4OULhZTdFFhZgSw3MmHCyC/xorQzzWVGd+ka6kKw7CDHeGy9pbtnG9T45enN3pidEvLGoZbWTjITYkU8KKq4sKVGWX3TZNjoMh8cPW3iwAimv1xtrAlRcnvJqbZFd6+Yk9/k8z28HjGdZL0VJmOken+TQBYpFrApDPq8s6Ex9A==\\r\\nx-forefront-antispam-report: \\r\\n CIP:255.255.255.255;CTRY:;LANG:en;SCL:1;SRV:;IPV:NLI;SFV:NSPM;H:BY5PR08MB6421.namprd08.prod.outlook.com;PTR:;CAT:NONE;SFS:(4636009)(366004)(7336002)(38070700005)(6636002)(8936002)(71200400001)(75432002)(7276002)(186003)(40140700001)(7406005)(7366002)(5660300002)(52536014)(9326002)(9686003)(86362001)(7416002)(38100700002)(8676002)(65686005)(66946007)(122000001)(76576003)(88732003)(6506007)(6862004)(26005)(33656002)(2906002)(55016002)(508600001)(76116006)(66446008)(83380400001)(64756008)(66556008)(66476007)(7696005)(316002);DIR:OUT;SFP:1101;\\r\\nx-ms-exchange-antispam-messagedata-chunkcount: 1\\r\\nx-ms-exchange-antispam-messagedata-0: \\r\\n =?us-ascii?Q?mJgDY4cWfu4jCsK2KaKySaoBzkKmjniuCIZjlht5ojlZqM35hmk99WK6TOz1?=\\r\\n =?us-ascii?Q?nWXtNHqF7vDHn6Mtton+IE7OpPhLS/Sw5sp0MnrWVNQQMtIo9BKRYQMb2LAY?=\\r\\n =?us-ascii?Q?hmH0y+Ac8rPuCejdqKjQSUamzm16+izZQlKuhyRTi7kTy5PKQaByiqJNOSGf?=\\r\\n =?us-ascii?Q?9+DVo5AROuqhN72jRF/fTJ9cc30zH8O0Wlmw5puO7Ein4Eap1EO+2WQsqnvF?=\\r\\n =?us-ascii?Q?8Um97kU5XgfGaX6s427XWkCUt7QmG08fLZ/ala9uDuqrCfEJ+HOuWWEoDfDT?=\\r\\n =?us-ascii?Q?OqFgfFOLfxUEbgvs6OAQYqxEvH6x7vTkhx0NRmgkplcvCYJoqX8PJVHI7ORP?=\\r\\n =?us-ascii?Q?Xb5ad+3b72HKagPVFfzYwZqY8GUz2OMs5U5KXIEwdYpMf7g4PHtRAq1RQvDc?=\\r\\n =?us-ascii?Q?QSuQesRNwSb/YgwirB13XwBAh1tAnbYDxCt83kCB4FhkwXH8whTzshanOgiD?=\\r\\n =?us-ascii?Q?8d68kwoUiRqa4b9x2bl4ciZCi3IL6jLamCbaXS+AAzp+fAlKMf4hHCo8nOj6?=\\r\\n =?us-ascii?Q?ehKW3HhwRZYEkedE18ild40QoEM8PdiosNE96P/mO/klwuDGgRtHDy0q9YXF?=\\r\\n =?us-ascii?Q?MxaunwD2JzIKjrEA/MfUP5cMQr32yWZmG5gZdmT3Mp6h/6IU/zLLzKC+2aWD?=\\r\\n =?us-ascii?Q?dfpUpj5TXEJojYDzOVfFDRNnt6AEYHKTyxJ93xpgPSkItSVi4S+WsH4aImT9?=\\r\\n =?us-ascii?Q?yHw0/xE2kFDQJOgHRJzIFILMFC/8aMP52PKZmDIDhi94bHL4JcAYziRYF+Kc?=\\r\\n =?us-ascii?Q?XZECleWi7aeuho8BWHKAu+F2KC4F7iwMbparQtVNrvt7ssC9bL4t3McCbxAw?=\\r\\n =?us-ascii?Q?EjtlQ5yr5RdJ6J7KhsE0/8HckDXCXOsQLBVUOLlOnP3l1sjjmUnIR2rRiOgl?=\\r\\n =?us-ascii?Q?6YGKpAiYBZ4ffPdpO5OxkKLLVugBOqRXkuscsnIK4TfAyO6rOz7bdyzAkOwC?=\\r\\n =?us-ascii?Q?/KoE0T8EgzpbpblUNmcMuxVkrv/m1yl5bPr0hIZLHWLCsIEnVNxqAp8nowjS?=\\r\\n =?us-ascii?Q?IHPLwv6vJIgDqLF1ZRGrozDeruUqjaHaa4FRFZQFhVFklHQmy57EZoFqBV5A?=\\r\\n =?us-ascii?Q?6IGPoGmcDSCGqWiHVmUiOg+/GIs5ycsimdrpAQWhA3AEZgA6gobGkYycUqh2?=\\r\\n =?us-ascii?Q?CQzMDQgqKjCjjKusNCwI6DnB8fbXjfXIgObaug4Fv1AOVkh3TtT5eGpoYLFx?=\\r\\n =?us-ascii?Q?oMGRRCcZ6zxs1KNioGVs5DrWXVZaYLbhP2IJu68mit40h4Dm5fN8pZHHpNwO?=\\r\\n =?us-ascii?Q?fTP71Fm71vf1FJvzan2+JQAdaumadTenI3JL+PLe8jKjo4s4+uPlV7gZJMxe?=\\r\\n =?us-ascii?Q?R2xOoY3sHo/GePYfB+HC5cWE?=\\r\\nContent-Type: multipart/alternative;\\r\\n\\tboundary=\"_000_BY5PR08MB6421D3689498FE99696DD77689A89BY5PR08MB6421namp_\"\\r\\nMIME-Version: 1.0\\r\\nX-MS-Exchange-CrossTenant-AuthAs: Internal\\r\\nX-MS-Exchange-CrossTenant-AuthSource: BY5PR08MB6421.namprd08.prod.outlook.com\\r\\nX-MS-Exchange-CrossTenant-Network-Message-Id: \\r\\n cb48c39c-7069-4e77-dedc-08d982ad00af\\r\\nX-MS-Exchange-CrossTenant-originalarrivaltime: 28 Sep 2021 18:22:58.6344\\r\\n (UTC)\\r\\nX-MS-Exchange-CrossTenant-fromentityheader: Hosted\\r\\nX-MS-Exchange-CrossTenant-id: c6fc6e9b-51fb-48a8-b779-9ee564b40413\\r\\nX-MS-Exchange-CrossTenant-mailboxtype: HOSTED\\r\\nX-MS-Exchange-CrossTenant-userprincipalname: \\r\\n P0ChLAslatLmij9hSSKi2GHMjyS3N96CaPWAc09i1s9Z8GjXP5WGJ6zBAQCmIL8F\\r\\nX-MS-Exchange-Transport-CrossTenantHeadersStamped: SJ0PR08MB6734\\r\\nX-OriginatorOrg: byu.edu\\r\\nX-Bayes-Prob: 0.0001 (Score 0, tokens from: Exchange, byu-edu:default,\\r\\n base:default, @@RPTN)\\r\\nX-Spam-Score: 0.02 () [Hold at 5.00] HTML_MESSAGE:0.01,C92(0.01)\\r\\nX-CanIt-Geo: ip=128.187.16.131; country=US; region=Utah; city=Mapleton;\\r\\n latitude=40.1300; longitude=-111.5783;\\r\\n http://maps.google.com/maps?q=40.1300,-111.5783&z=6\\r\\nX-CanItPRO-Stream: byu-edu:Exchange (inherits from\\r\\n byu-edu:default,base:default)\\r\\nX-Canit-Stats-ID: 045XunHaH - 8694ab1d80b3 - 20210928\\r\\nX-Scanned-By: CanIt (www . roaringpenguin . com)\\r\\n\\r\\n--_000_BY5PR08MB6421D3689498FE99696DD77689A89BY5PR08MB6421namp_\\r\\nContent-Type: text/plain; charset=\"us-ascii\"\\r\\nContent-Transfer-Encoding: quoted-printable\\r\\n\\r\\nHello Student,\\r\\n\\r\\nI am reaching out to you personally and let you know that you are eligible =\\r\\nto take the HONRS 310: Foundations of Interdisciplinary Leadership (1 credi=\\r\\nt) class in the second term of this semester. This course will go over the =\\r\\nfoundations of good interdisciplinary leadership and it will be taught by a=\\r\\nn amazing faculty.  Students that had taken this course said it was a lot o=\\r\\nf fun and they learned about themselves as a leader and how to make a posit=\\r\\nive impact on others!  This class is an excellent opportunity to prepare yo=\\r\\nu for your Leadership Development Experience (HONRS 390R) in Spring and Sum=\\r\\nmer semesters. The class meets ONLY on Tuesdays from 3:00 - 4:50 PM.\\r\\n\\r\\nIf you are interested in enrolling in this class, go ahead and add it into =\\r\\nyour schedule, no add code necessary.\\r\\n\\r\\nLet me know if you have any questions!\\r\\n\\r\\nSincerely,\\r\\n\\r\\n\\r\\nVika S. Filimoeatu\\r\\nAdvisement Supervisor, Honors Program\\r\\nBrigham Young University\\r\\n102B MSRB\\r\\nProvo, UT 84602\\r\\nPhone: 801.422.1997\\r\\nEmail: vika_filimoeatu@byu.edu<mailto:vika_filimoeatu@byu.edu>\\r\\n\\r\\n\\r\\n--_000_BY5PR08MB6421D3689498FE99696DD77689A89BY5PR08MB6421namp_\\r\\nContent-Type: text/html; charset=\"us-ascii\"\\r\\nContent-Transfer-Encoding: quoted-printable\\r\\n\\r\\n<html xmlns:v=3D\"urn:schemas-microsoft-com:vml\" xmlns:o=3D\"urn:schemas-micr=\\r\\nosoft-com:office:office\" xmlns:w=3D\"urn:schemas-microsoft-com:office:word\" =\\r\\nxmlns:m=3D\"http://schemas.microsoft.com/office/2004/12/omml\" xmlns=3D\"http:=\\r\\n//www.w3.org/TR/REC-html40\">\\r\\n<head>\\r\\n<meta http-equiv=3D\"Content-Type\" content=3D\"text/html; charset=3Dus-ascii\"=\\r\\n>\\r\\n<meta name=3D\"Generator\" content=3D\"Microsoft Word 15 (filtered medium)\">\\r\\n<style><!--\\r\\n/* Font Definitions */\\r\\n@font-face\\r\\n\\t{font-family:\"Cambria Math\";\\r\\n\\tpanose-1:2 4 5 3 5 4 6 3 2 4;}\\r\\n@font-face\\r\\n\\t{font-family:Calibri;\\r\\n\\tpanose-1:2 15 5 2 2 2 4 3 2 4;}\\r\\n@font-face\\r\\n\\t{font-family:\"Segoe UI\";\\r\\n\\tpanose-1:2 11 5 2 4 2 4 2 2 3;}\\r\\n/* Style Definitions */\\r\\np.MsoNormal, li.MsoNormal, div.MsoNormal\\r\\n\\t{margin:0in;\\r\\n\\tfont-size:11.0pt;\\r\\n\\tfont-family:\"Calibri\",sans-serif;}\\r\\na:link, span.MsoHyperlink\\r\\n\\t{mso-style-priority:99;\\r\\n\\tcolor:#0563C1;\\r\\n\\ttext-decoration:underline;}\\r\\nspan.markzlxg4gndh\\r\\n\\t{mso-style-name:markzlxg4gndh;}\\r\\n.MsoChpDefault\\r\\n\\t{mso-style-type:export-only;\\r\\n\\tfont-size:10.0pt;}\\r\\n@page WordSection1\\r\\n\\t{size:8.5in 11.0in;\\r\\n\\tmargin:1.0in 1.0in 1.0in 1.0in;}\\r\\ndiv.WordSection1\\r\\n\\t{page:WordSection1;}\\r\\n--></style><!--[if gte mso 9]><xml>\\r\\n<o:shapedefaults v:ext=3D\"edit\" spidmax=3D\"1026\" />\\r\\n</xml><![endif]--><!--[if gte mso 9]><xml>\\r\\n<o:shapelayout v:ext=3D\"edit\">\\r\\n<o:idmap v:ext=3D\"edit\" data=3D\"1\" />\\r\\n</o:shapelayout></xml><![endif]-->\\r\\n</head>\\r\\n<body lang=3D\"EN-US\" link=3D\"#0563C1\" vlink=3D\"#954F72\" style=3D\"word-wrap:=\\r\\nbreak-word\">\\r\\n<div class=3D\"WordSection1\">\\r\\n<p style=3D\"margin-bottom:6.0pt;background:white\"><span style=3D\"font-famil=\\r\\ny:&quot;Segoe UI&quot;,sans-serif;color:#172B4D\">Hello Student,<o:p></o:p><=\\r\\n/span></p>\\r\\n<p style=3D\"background:white;text-overflow:ellipsis\"><span style=3D\"font-fa=\\r\\nmily:&quot;Segoe UI&quot;,sans-serif;color:#172B4D\">I am reaching out to yo=\\r\\nu personally and let you know that you are eligible to take the\\r\\n<b><u>HONRS&nbsp;<span class=3D\"markzlxg4gndh\">310</span>: Foundations of I=\\r\\nnterdisciplinary Leadership (1 credit) class\\r\\n</u></b>in the second term of this semester. This course will go over the f=\\r\\noundations of good interdisciplinary leadership and it will be taught by an=\\r\\n amazing faculty. &nbsp;Students that had taken this course said it was a l=\\r\\not of fun and they learned about themselves\\r\\n as a leader and how to make a positive impact on others!&nbsp; This class =\\r\\nis an excellent opportunity to prepare you for your Leadership Development =\\r\\nExperience (HONRS 390R) in Spring and Summer semesters. The class meets ONL=\\r\\nY on Tuesdays from 3:00 &#8211; 4:50 PM.&nbsp;\\r\\n<o:p></o:p></span></p>\\r\\n<p style=3D\"margin-bottom:6.0pt;background:white\"><span style=3D\"font-famil=\\r\\ny:&quot;Segoe UI&quot;,sans-serif;color:#172B4D\">If you are interested in e=\\r\\nnrolling in this class, go ahead and add it into your schedule, no add code=\\r\\n necessary.\\r\\n<o:p></o:p></span></p>\\r\\n<p style=3D\"margin-bottom:6.0pt;background:white;text-overflow:ellipsis\"><s=\\r\\npan style=3D\"font-family:&quot;Segoe UI&quot;,sans-serif;color:#172B4D\">Let=\\r\\n me know if you have any questions!<o:p></o:p></span></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"text-overflow:ellipsis\"><o:p>&nbsp;</o:p></=\\r\\np>\\r\\n<p class=3D\"MsoNormal\"><span style=3D\"font-family:&quot;Segoe UI&quot;,sans=\\r\\n-serif;color:#172B4D\">Sincerely,<o:p></o:p></span></p>\\r\\n<p class=3D\"MsoNormal\"><o:p>&nbsp;</o:p></p>\\r\\n<p class=3D\"MsoNormal\"><o:p>&nbsp;</o:p></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<b><span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:black=\\r\\n\">Vika S. Filimoeatu<o:p></o:p></span></b></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:black\">A=\\r\\ndvisement Supervisor, Honors Program</span><o:p></o:p></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<b><span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:#1F4E=\\r\\n79\">Brigham Young University</span></b><o:p></o:p></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:black\">1=\\r\\n02B MSRB</span><o:p></o:p></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:black\">P=\\r\\nrovo, UT 84602<o:p></o:p></span></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:black\">P=\\r\\nhone: 801.422.1997</span><o:p></o:p></p>\\r\\n<p class=3D\"MsoNormal\" style=3D\"mso-margin-top-alt:auto;mso-margin-bottom-a=\\r\\nlt:auto;mso-add-space:auto\">\\r\\n<span style=3D\"font-family:&quot;Times New Roman&quot;,serif\">Email:</span>=\\r\\n <a href=3D\"mailto:vika_filimoeatu@byu.edu\">\\r\\n<span style=3D\"font-family:&quot;Times New Roman&quot;,serif;color:blue\">vi=\\r\\nka_filimoeatu@byu.edu</span></a><o:p></o:p></p>\\r\\n<p class=3D\"MsoNormal\"><o:p>&nbsp;</o:p></p>\\r\\n</div>\\r\\n</body>\\r\\n</html>\\r\\n\\r\\n--_000_BY5PR08MB6421D3689498FE99696DD77689A89BY5PR08MB6421namp_--\\r\\n\\r\\n'"
"""



file_path = "~/data/zarr.zarr"
NUM_FILES = 12531

print(len(LARGE_STRING))

# json_string = json.loads(LARGE_STRING, strict=False)
# json_string = json_string["data"]["mbox"]

CHUNK_SIZE = 50
store = zarr.NestedDirectoryStore(file_path)
# data = zarr.create(shape=NUM_FILES, chunks=CHUNK_SIZE, 
#                 store=store, dtype=str)

data = zarr.open(file_path, mode='a')

existing_zarr = zarr.open("/home/dallin/miniconda3/envs/emails/lib/python3.9/site-packages/rootflow/datasets/data/EmailCorpus/data/email_data.zarr", mode='a')

temp_store = []
store_index = 0
zarr_initial_index = 0
total_bytes = 0
# for i in tqdm(range(NUM_FILES), total=NUM_FILES, smoothing=.9):

#     full_item = str(existing_zarr[i])
#     total_bytes += len(full_item)

#     if len(temp_store) < CHUNK_SIZE:
#         temp_store.append(full_item)
#         store_index += 1
#     elif len(temp_store) == CHUNK_SIZE and store_index < CHUNK_SIZE:
#         temp_store[store_index] = full_item
#         store_index += 1
#     else:
#         #insert full chunk into zarr
#         data[zarr_initial_index:i] = temp_store
#         zarr_initial_index = i
#         temp_store[0] = full_item
#         store_index = 1

#     if i == NUM_FILES - 1:
#         #could have a partial chunk so we insert now
#         data[zarr_initial_index:i+1] = temp_store[0:store_index]

print("Done filling the zarr")
print(f"The zarr was filled with {total_bytes} bytes")

for i in tqdm(range(NUM_FILES), total=NUM_FILES):
    data[i]